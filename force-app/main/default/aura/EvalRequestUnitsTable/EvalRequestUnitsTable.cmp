<aura:component controller="EvalUnitstoQuote"
    implements="flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,force:lightningQuickActionWithoutHeader,lightning:availableForFlowScreens">
    <aura:attribute name="records" type="Eval_Unit_Details__c[]" access="public" />
    <aura:attribute name="flowname" type="String" access="public" />
    <aura:attribute name="quoteid" type="String" access="public" />
    <aura:attribute name="recordId" type="String" />
    <aura:attribute name="unitSelected" type="Eval_Unit_Details__c[]" />
    <aura:attribute name="actname" type="String" />
    <aura:attribute name="header" type="String" default="Select Evals to Send out for Quote" />
    <aura:attribute name="btnnext" type="boolean" />

    <aura:handler name="change" value="{!v.btnnext}" action="{!c.returnflow}" />
    <aura:attribute name="selected" type="Eval_Unit_Details__c[]" access="public" />
    <aura:attribute name="completed" type="boolean" />
    <aura:attribute name="flowRun" type="boolean" default="false" />
    <aura:attribute name="showbtn" type="boolean" default="false" />
    <aura:handler name="init" action="{!c.init}" value="{!this}" />
    <aura:attribute name="accessCheck" type="Boolean" default="false" />
    <aura:attribute name="confirmationPage" type="boolean" default="false"
        description="shows the EvalUnits in read only" />
    <aura:attribute name="shippingconfirmationPage" type="boolean" default="false"
        description="shows the EvalUnits in read only" />
    <aura:attribute name="quoted" type="Boolean" />
    <aura:attribute name="transferEval" type="Boolean" />
    <aura:attribute name="returnEval" type="Boolean" />
    <aura:attribute name="totalEvalPrice" type="String"
        description="when using in read only, displays the total cost in string format" />
    <aura:attribute name="TotalPrice" type="Double"
        description="when using in read only, displays the total cost in Double format" />

    <div aura:id="evalunitsv2" class="">
        <div class="slds-card__header slds-grid">
            <header class="slds-media slds-media_center slds-has-flexi-truncate">
                <div class="slds-media__body">
                    <h2>
                        <span class="slds-text-heading_small">{!v.header}</span>
                    </h2>
                </div>
            </header>
        </div>
        <table class="slds-table slds-table_bordered slds-table_cell-buffer">
            <thead>
                <tr class="slds-text-title_caps">
                    <aura:if isTrue="{!and(not(v.confirmationPage),not(v.shippingconfirmationPage))}">
                        <th scope="col">
                        </th>
                    </aura:if>
                    <th scope="col">
                        <div class="slds-truncate" title="Account Name">SKU</div>
                    </th>
                    <th scope="col">
                        <div class="slds-truncate" title="Serial">Serial Number</div>
                    </th>
                    <th scope="col">
                        <div class="slds-truncate" title="Quantity">Price</div>
                    </th>
                    <aura:if isTrue="{!v.confirmationPage}">
                        <th scope="col">
                            <div class="slds-truncate" title="Recycle Fees">Recycle Fees</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Tax Rate">Tax Rate</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Total">Total</div>
                        </th>
                    </aura:if>

                    <aura:if isTrue="{!v.accessCheck}">
                        <th scope="col">
                            <div class="slds-truncate" title="Quantity">Special Eval Price</div>
                        </th>
                        <!--
                        <th scope="col">
                            <div class="slds-truncate" title="Quantity">UseSplPrice</div>
                        </th>     
                        -->
                    </aura:if>

                </tr>
            </thead>
            <tbody>
                <aura:iteration items="{!v.records}" var="u">
                    <aura:if isTrue="{!or(or(and(not(v.confirmationPage),not(v.shippingconfirmationPage)),
                    u.Quote_Product__c),u.Unit_Selected__c)}">
                        <tr>
                            <aura:if isTrue="{!and(not(v.confirmationPage),not(v.shippingconfirmationPage))}">
                                <td>

                                    
                                    <lightning:input disabled="{!u.noEvalPrice__c}" type="checkbox-button" label=""
                                        name="{!u.Id}" aura:id="DependentCheckboxpart" value="false" checked="false" />

                                </td>
                            </aura:if>
                            <td>
                                <ui:outputText value="{!u.SKU__r.Name }" />
                            </td>
                            <td>
                                <ui:outputText value="{!u.Name}" />
                            </td>
                            <aura:if isTrue="{!not(v.confirmationPage)}">
                                <td>
                                    <aura:if isTrue="{!u.noEvalPrice__c}">
                                        Please Request Pricing to lori.smith@viewsonic.com
                                        <aura:set attribute="else">
                                            <ui:outputCurrency value="{!u.Evaluation_Price__c}" />
                                        </aura:set>
                                    </aura:if>
                                </td>
                            </aura:if>
                            <aura:if isTrue="{!v.confirmationPage}">
                                <td>

                                    <ui:outputCurrency value="{!u.Low_Eval_Price__c}" />

                                </td>
                                <td>
                                    <ui:outputCurrency value="{!u.Recycle_Fee__c}" />
                                </td>
                                <td>
                                    <ui:outputNumber value="{!u.Tax_Rate__c}" />
                                </td>
                        <tr>
                            <td>
                                <ui:outputCurrency value="{!u.TotalPrice__c}" />
                            </td>
                        </tr>
                    </aura:if>
                    <aura:if isTrue="{!v.accessCheck}">
                        <td>
                            <ui:inputCurrency aura:id="amount" class="field" value="{!u.Special_Eval_Price__c}" />
                        </td>
                    </aura:if>
                    </tr>
                    </aura:if>
                </aura:iteration>

            </tbody>

        </table>

        <aura:if isTrue="{!v.confirmationPage}">
            <table class="slds-table slds-table_cell-buffer">
                <tr class="slds-text-title_caps" style="float:right;padding-right:7%">
                    <b>
                        <ui:outputCurrency value="{!v.TotalPrice}" />
                    </b>
                </tr>
            </table>
        </aura:if>
        <br />
        <!--<apex:param name="ColEvalUnits" value="{!Selected}"/>-->
        <aura:if isTrue="{!not(v.confirmationPage)}">
            <aura:if isTrue="{!v.showbtn}">

                <lightning:button label="Next Page" variant="brand" onclick="{!c.startflow}" class="slds-float_right" />
                <aura:set attribute="else">
                    <lightning:card>
                        <aura:set attribute="actions">
                            <aura:if isTrue="{!not(v.shippingconfirmationPage)}">
                                <!--<lightning:button class="slds-m-top_small" type="submit" label="Previous" onclick="{!c.flowPrev}"/>-->
                                <lightning:button class="slds-m-top_small" type="submit" label="Next" variant="brand"
                                    onclick="{!c.startflow}" />
                            </aura:if>
                        </aura:set>
                    </lightning:card>
                </aura:set>
            </aura:if>
        </aura:if>
        <!--startflow-->
    </div>
    <aura:if isTrue="{!not(v.shippingconfirmationPage)}">
        <div aura:id="flow">
            <lightning:flow aura:id="flowquote" onstatuschange="{!c.flowComplete}" />
            <!--onstatuschange="{!c.flowComplete}" -->
        </div>
    </aura:if>

</aura:component>